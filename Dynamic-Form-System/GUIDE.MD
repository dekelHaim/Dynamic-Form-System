# ğŸš€ Dynamic Form System - Quick Guide

## ğŸ“Š What It Does
- âœ… Create forms from JSON schemas
- âœ… Dynamic field validation (text, email, number, date, dropdown)
- âœ… Store submissions in PostgreSQL
- âœ… Detect duplicates + analytics
- âœ… Cache with Redis
- âœ… Docker + Nginx + FastAPI

---

## ğŸ—ï¸ Architecture Flow

```
Browser/Postman (Port 80)
        â†“
    NGINX (Reverse Proxy)
        â†“
  FastAPI (Port 8000)
    â”œâ”€ /api/forms (CRUD)
    â”œâ”€ /api/submissions (CRUD)
    â””â”€ / (UI)
        â†“
  Validators (Pydantic)
        â†“
  Cache: Redis (1hr TTL)
        â†“
  DB: PostgreSQL
```

---

## ğŸš€ How to Run

### Development (Direct)
```bash
python main.py
# Opens: http://localhost:8000
```

### Production (Docker)
```bash
docker-compose up -d
# Starts: Nginx + FastAPI + PostgreSQL + Redis
# Access: http://localhost (Port 80)
```

---

## ğŸ§ª Test with Postman/curl

### 1ï¸âƒ£ Create Form
```bash
curl -X POST http://localhost/api/forms/ \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Contact Form",
    "description": "Test contact",
    "schema_definition": {
      "name": {"type": "string", "required": true, "minLength": 3},
      "email": {"type": "email", "required": true},
      "age": {"type": "number", "required": true, "min": 18, "max": 100},
      "gender": {"type": "dropdown", "options": ["male", "female", "other"], "required": true}
    }
  }'
```
**Response:** `{"id": 1, "name": "Contact Form", ...}`

---

### 2ï¸âƒ£ Get All Forms
```bash
curl http://localhost/api/forms/
```
**Response:** Lists all forms with user_details stored

---

### 3ï¸âƒ£ Submit Data (Valid)
```bash
curl -X POST http://localhost/api/submissions/?form_id=1 \
  -H "Content-Type: application/json" \
  -d '{
    "data": {
      "name": "John Doe",
      "email": "john@example.com",
      "age": 25,
      "gender": "male"
    }
  }'
```
**Response:** `{"success": true, "submission_id": 5, ...}`

---

### 4ï¸âƒ£ Submit Data (Invalid - Rejected)
```bash
curl -X POST http://localhost/api/submissions/?form_id=1 \
  -H "Content-Type: application/json" \
  -d '{
    "data": {
      "name": "ab",
      "email": "invalid-email",
      "age": 200,
      "gender": "unknown"
    }
  }'
```
**Response:** `422 Unprocessable Entity`
```json
{
  "detail": [
    "name: minimum length 3",
    "email: invalid format",
    "age: must be < 100",
    "gender: invalid option"
  ]
}
```

---

### 5ï¸âƒ£ Get Submissions
```bash
curl http://localhost/api/submissions/?form_id=1&limit=10&skip=0
```
**Response:** Paginated submissions + analytics

---

### 6ï¸âƒ£ Get Form by ID
```bash
curl http://localhost/api/forms/1
```
**Response:** Full form with user_details

---

### 7ï¸âƒ£ Update Form
```bash
curl -X PUT http://localhost/api/forms/1 \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Updated Form",
    "description": "New description"
  }'
```

---

### 8ï¸âƒ£ Delete Form
```bash
curl -X DELETE http://localhost/api/forms/1
```

---

## ğŸ³ Docker Services Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        NGINX (Port 80)              â”‚ â† User hits here
â”‚  â”œâ”€ Reverse proxy                   â”‚
â”‚  â””â”€ â†’ Forward to FastAPI:8000       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     FastAPI (Port 8000)             â”‚ â† Business logic
â”‚  â”œâ”€ /api/forms                      â”‚
â”‚  â”œâ”€ /api/submissions                â”‚
â”‚  â”œâ”€ Validators (Pydantic)           â”‚
â”‚  â””â”€ Middleware (error, log, cache)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                 â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚ PostgreSQLâ”‚    â”‚   Redis   â”‚
â”‚ (DB)     â”‚    â”‚ (Cache)   â”‚
â”‚ Port 5432â”‚    â”‚ Port 6379 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


## ğŸ“ˆ Performance

| Action | Time (DB) | Time (Cache) |
|--------|-----------|--------------|
| GET /forms/ | ~100ms | ~5ms âš¡ |
| POST /submissions/ | ~80ms | (always fresh) |
| GET /submissions/ | ~150ms | ~10ms âš¡ |

**Cache TTL:** 1 hour | Invalidates on POST/PUT/DELETE

---

## ğŸ”’ Environment Variables

Set in `docker-compose.yml`:

```yaml
DATABASE_URL: postgresql://user:password@postgres:5432/formdb
REDIS_URL: redis://redis:6379
ENV: production
DEBUG: False
```

---

## âœ… Tech Stack

- **Backend:** FastAPI (Python)
- **Validation:** Pydantic
- **Database:** PostgreSQL 15
- **Cache:** Redis 7
- **Proxy:** Nginx
- **Container:** Docker + docker-compose
- **Server:** Gunicorn (production)

---


---

## ğŸ“ API Endpoints Summary

| Method | Endpoint | Purpose |
|--------|----------|---------|
| **GET** | `/api/forms/` | List all forms |
| **POST** | `/api/forms/` | Create form |
| **GET** | `/api/forms/{id}` | Get form detail |
| **PUT** | `/api/forms/{id}` | Update form |
| **DELETE** | `/api/forms/{id}` | Delete form |
| **POST** | `/api/submissions/` | Submit data |
| **GET** | `/api/submissions/` | List submissions |

---
